<!DOCTYPE html>
<html>

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Gostations Direction</title>
    <%= Gon::Base.render_data %>
    <style>
     
      html, body {
        height: 100%;
        margin: 50;
        padding: 50;
      }
      #map {
        height: 100%;
        width: 90%;
        margin: auto;
      }

      #directions-panel {
        margin-top: 10px;
        background-color: #FFEE77;
        padding: 10px;
      }
    </style>
  </head>

  <body class="background">
    <div class="half-oval">
      <div class="half-oval-inner">
        <button class="btn  trip-button" data-toggle="modal" data-target="#myModal"><%= @trip.name%></button>
      </div>
    </div>
    <div id="myModal" class="modal fade" role="dialog">
      <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content trip-button">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title"><%= @trip.name%></h4>
      </div>
      <div class="modal-body">
        <p>"description here"在一週內完成以下五個夜市景點，即可獲得夜市達人徽章及100points."最快完成者:Mike"</p>
      </div>
    </div>

  </div>
</div>
    <div id="myProgress" class="float-right" onclick="move()">
      <div id="myBar"></div>
    </div>
    <div id="map"></div>
  

    <script type="text/javascript">
      function move(){
        var elem = document.getElementById("myBar");
        var width = 25;
        var id = setInterval(frame,10);
        function frame(){
          if (width >= 100){
            clearInterval(id);
          }
          else{
            width+= 25;
            elem.style.width = width + '%';
          }
        }
      }
    </script>
    <script>

      var map = null;
      var infoWindow = null;

      function showGostations(){
        for(var i=0; i<gon.gostations.length; i++){
          var position = {};
          position.lat = +gon.gostations[i].Latitude;
          position.lng = +gon.gostations[i].Longitude;
          var LocName = gon.gostations[i].LocName;
          addMarker({
            coords: position,
            iconImage: 'http://maps.google.com/mapfiles/ms/micons/yellow-dot.png',
            content: '<a href="https://www.google.com/maps/dir/Current+Location/'+LocName+'" target="_blank">'+LocName+'</a>'
          });
        }
      }

      function addMarker(props){
        var marker = new google.maps.Marker({
          position: props.coords,
          map: map,
          icon: props.iconImage
        });

        if(props.content){
          marker.addListener('click', function(){
            if(infoWindow==null){
              infoWindow = new google.maps.InfoWindow();
            }
            infoWindow.setContent(props.content);
            infoWindow.open(map, marker);
          });
        }
      }

      function initMap() {

        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 8,
          center: {lat: 23.96099, lng: 120.97186},
          styles: [
  {
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#212121"
      }
    ]
  },
  {
    "elementType": "labels.icon",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "elementType": "labels.text.stroke",
    "stylers": [
      {
        "color": "#212121"
      }
    ]
  },
  {
    "featureType": "administrative",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "administrative.country",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  },
  {
    "featureType": "administrative.land_parcel",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "administrative.locality",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#bdbdbd"
      }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#181818"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#616161"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "labels.text.stroke",
    "stylers": [
      {
        "color": "#1b1b1b"
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "geometry.fill",
    "stylers": [
      {
        "color": "#2c2c2c"
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#8a8a8a"
      }
    ]
  },
  {
    "featureType": "road.arterial",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#373737"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#3c3c3c"
      }
    ]
  },
  {
    "featureType": "road.highway.controlled_access",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#4e4e4e"
      }
    ]
  },
  {
    "featureType": "road.local",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#616161"
      }
    ]
  },
  {
    "featureType": "transit",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#000000"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#3d3d3d"
      }
    ]
  }
]
        });

        showGostations();
      }

    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDBlueY1pKWgE_uhgFbjH8_cO2CjJCERaA&callback=initMap">
    </script>

  </body>
</html>
